<html> 
<script src="/socket.io/socket.io.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>


<h1> 500px/Fresh Today </h1>
<p class='data'></p> 

<script type='text/javascript'>
	//var socket = io.connect('http://px-stream.herokuapp.com')
	var data = <%- data %>

	var socket = io.connect('<%= host %>')
	for (var i in data.reverse())
		$('.data').prepend("<a id='photo' href='http://500px.com/photo/" + data[i].id + "'> <img src='" + data[i].url + "'></a>" )


	var size = 50;
	socket.on('fresh_today', function (data) {
		if ($('.data').children().size() > size) {
			$('.data').children().last().remove()
		}
		
		$('.data').prepend("<a id='photo' href='http://500px.com/photo/" + data.id + "'> <img src='" + data.url + "'></a>" )
	})
</script>

<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-34752730-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

</html>